# Format Learning Note

学習メモファイル（`*_learning/*.md`）の見出し構造を整理するコマンドです。複数の質問と回答が追加された際に、見出しレベルを統一して読みやすくします。

## 使用方法

1. 学習メモファイル（`*_learning/*.md`）を開いている状態でこのコマンドを実行
2. または、ファイルパスを指定して実行
3. 見出し構造が自動的に整理されます

## 処理フロー

以下の手順で処理を実行してください：

### 1. ファイルの検出

現在開いているファイルまたはユーザーが指定したファイルから、学習メモファイルを特定します。

- 現在開いているファイルが `*_learning/*.md` 形式の場合：
  - そのファイルを処理対象とする
- ユーザーがファイルパスを指定した場合：
  - 指定されたファイルを処理対象とする

### 2. ファイル内容の読み込み

学習メモファイルの内容を読み込み、現在の構造を確認します。

### 3. 見出し構造の整理

以下のルールに従って見出し構造を整理します：

#### 見出しレベルの統一

- **h1**: タイトル（`# <トピック名> - 学習メモ`）
- **h2**: トップレベルのセクション（`## 質問`, `## 回答`, `## 参考リンク`）
- **h3**: 回答内のサブセクション（`### 1. タイトル`, `### まとめ`, `### 追加の解説`, `### 実用例` など）

#### 構造の整理ルール

1. **質問と回答のペア化**
   - 各「## 質問」の直後に「## 回答」が続くように配置
   - 質問と回答の間に他のh2セクションが入らないようにする

2. **サブセクションの統合**
   - 「## 追加の解説」→ 直前の回答内の「### 追加の解説」に変更
   - 「## 実用例」→ 直前の回答内の「### 実用例」に変更
   - 「## まとめ」→ 直前の回答内の「### まとめ」に変更

3. **区切り線の追加**
   - 各質問セクション（質問+回答）の後に区切り線（`---`）を追加
   - 最後の質問セクションと「## 参考リンク」の間にも区切り線を追加

4. **参考リンクの配置**
   - 「## 参考リンク」は常にファイルの最後に配置

#### 整理後の構造例

```markdown
# <トピック名> - 学習メモ

> **元の解説**: [...]
> **ソースコード**: [...]
> **作成日**: YYYY-MM-DD

## 質問

<質問1の内容>

## 回答

<回答1の内容>

### 1. サブセクション1

### 2. サブセクション2

### まとめ

### 追加の解説

### 実用例

---

## 質問

<質問2の内容>

## 回答

<回答2の内容>

### 1. サブセクション1

### まとめ

---

## 参考リンク

- [...]
```

### 4. ファイルの保存

整理された内容を元のファイルに保存します。

## 処理の詳細

### 見出しレベルの判定と変更

1. **h2レベルのセクションを確認**
   - 「質問」「回答」「参考リンク」以外のh2セクションを検出
   - これらを直前の回答内のh3に変更

2. **質問と回答のペアを確認**
   - 各「## 質問」の後に「## 回答」が続いているか確認
   - 順序が正しくない場合は修正

3. **区切り線の追加**
   - 各質問セクション（質問+回答）の後に区切り線を追加
   - ただし、最後の質問セクションと参考リンクの間にも追加

### 注意事項

- ファイルの先頭部分（メタデータ、作成日など）は変更しない
- コードブロック内の内容は変更しない
- リンクや参照は保持する
- 既存の区切り線（`---`）は重複しないように注意

## 使用例

### 例1: 学習メモファイルを開いている状態で実行

1. `01_basics_learning/01_packages.md` を開く
2. `/format-learning-note` コマンドを実行
3. 見出し構造が自動的に整理される

### 例2: ファイルパスを指定して実行

1. `/format-learning-note` コマンドを実行
2. 「`01_basics_learning/01_packages.md` を整理して」と指定
3. 見出し構造が自動的に整理される

## 処理前後の例

### 処理前（見出しがごちゃごちゃ）

```markdown
# Packages（パッケージ） - 学習メモ

## 質問
質問1

## 回答
回答1

### 1. サブセクション

## 追加の解説
追加情報

## 実用例
実用例

## 質問
質問2

## 回答
回答2

## 参考リンク
リンク
```

### 処理後（整理済み）

```markdown
# Packages（パッケージ） - 学習メモ

## 質問
質問1

## 回答
回答1

### 1. サブセクション

### 追加の解説
追加情報

### 実用例
実用例

---

## 質問
質問2

## 回答
回答2

---

## 参考リンク
リンク
```

## 注意事項

- 学習メモファイル（`*_learning/*.md`）のみを処理対象とします
- ファイルが存在しない場合はエラーメッセージを表示します
- ファイルの内容を大幅に変更するため、必要に応じてバックアップを取ることを推奨します
- 見出し構造が既に正しい場合は、最小限の変更のみ行います
